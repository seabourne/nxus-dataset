<!-- custom datasetsDatapresentationForm.ejs -->
<form role="form" action="" method="POST" class="form-horizontal form-bordered" id="validateForm">
    <input type="hidden" id="id" name="<%= idField %>" value="<%= object[idField] %>" />
    <div class="form-body">
        <div class="form-group">
            <label class="col-sm-3 to-right" for="control_name">Name</label>
            <div class="col-sm-7">
                <input type="text" id="control_name" class="form-control" value="<%= object.name %>" placeholder="Enter Name" name="name" required>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 to-right" for="control_label">Label</label>
            <div class="col-sm-7">
                <input type="text" id="control_label" class="form-control" value="<%= object.label %>" placeholder="Enter Label" name="label" >
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 to-right" for="control_fieldIds">Fields</label>
            <div class="col-sm-7">
                <select id="control_fieldIds" class="form-control" name="fieldIds" multiple>
            <%  if (locals.datasets) {
                    datasets.forEach( (dataset) => {
                        if (dataset.fields) {
                            dataset.fields.forEach( (field) => {
                                let selected = ( _.contains(object.fieldIds, field.id) ? "selected" : "" )

            %>
                    <option value="<%= field.id %>" <%= selected %> ><%=dataset.name + ": " + field.name %></option>       
            <%              })
                        }
                
                   })
                }
            %>
                </select>
            </div>
        </div>
    </div>
    <div class="form-group">
      <div class="col-sm-offset-3 col-sm-7">
        <button class="btn btn-theme" type="submit">Save</button>        
       </div>
    </div>

</form>